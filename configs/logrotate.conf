# Logrotate configuration for AgentHub audit logs
#
# Installation (macOS):
#   sudo cp configs/logrotate.conf /etc/newsyslog.d/agenthub.conf
#   sudo newsyslog -v  # Test configuration
#
# Installation (Linux):
#   sudo cp configs/logrotate.conf /etc/logrotate.d/agenthub
#   sudo logrotate -d /etc/logrotate.d/agenthub  # Test configuration
#
# Note: This file uses logrotate syntax. For macOS newsyslog, see logrotate-macos.conf

# /tmp/agenthub/audit.log
/tmp/agenthub/audit.log {
    # Rotate daily
    daily

    # Keep 90 days of logs
    rotate 90

    # Compress old logs
    compress
    delaycompress

    # Don't error if log file is missing
    missingok

    # Don't rotate if empty
    notifempty

    # Create new log with these permissions
    create 0644 visualval staff

    # Use date as a suffix (audit.log-20260128)
    dateext
    dateformat -%Y%m%d

    # Post-rotation script
    postrotate
        # Send SIGHUP to router if running (optional)
        # pkill -HUP -f "uvicorn router.main:app" || true
    endscript
}

# SQLite database doesn't need rotation
# /tmp/agenthub/activity.db is self-managed with cleanup API
